# B24 Interconnector

Микросервис-шина для обмена данными (сделками) между двумя независимыми облачными инстансами Битрикс24.

## Почему это решение необходимо (Key Features)

- **Гарантированная доставка**: Если один из Битрикс24 временно недоступен или тормозит, шина удерживает сделку в очереди и повторяет попытку позже. Данные не потеряются.
- **Защита от блокировок (Rate Limiting)**: При массовом поступлении сделок (до 10 000 одновременно) шина распределяет нагрузку, отправляя в Битрикс24 по 10–20 запросов в минуту, чтобы избежать бана со стороны API.
- **Обход лимитов URL (GET -> POST)**: Микросервис получает только ID сделки, а затем сам выкачивает все тяжелые данные (длинные комментарии, файлы) через POST-запросы, предотвращая обрезку данных сервером.
- **Связка сущностей**: Сервис хранит карту соответствий ID сделки в Системе А и Системе Б, что позволяет корректно возвращать обновления и комментарии в нужную карточку.

## Стек технологий
- PHP 8.1+ (Slim 4 Framework)
- MySQL (Очередь задач)
- Guzzle (HTTP-клиент для API Битрикс24)
- Composer (Управление зависимостями)

## Установка
1. Клонируйте репозиторий.
2. Выполните `composer install`.
3. Настройте `.env` файл на основе `.env.example`.
4. Импортируйте структуру базы данных из `database.sql`.

## Архитектура
1. `public/index.php` — входная точка для входящих вебхуков.
2. `bin/worker.php` — скрипт обработчика очереди (запускается по Cron).